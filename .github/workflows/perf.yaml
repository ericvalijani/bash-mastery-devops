# .github/workflows/perf.yaml
name: Performance Test

on:
  push:
    paths:
      - 'scripts/advanced/day12/**'
  workflow_dispatch:

jobs:
  benchmark:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Generate 100K test log
        run: |
          for i in {1..100000}; do
            echo "[INFO] Test log line $i from 10.0.0.$((i%255))" >> test.log
          done
      - name: Run analyzer
        run: |
          start=$(date +%s.%N)
          bash scripts/advanced/day12/log-analyzer.sh test.log
          end=$(date +%s.%N)
          duration=$(printf '%.3f' "$(bc <<< "$end - $start")")
          echo "Duration: ${duration}s" >> $GITHUB_STEP_SUMMARY
